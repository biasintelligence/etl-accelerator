<?xml version="1.0" encoding="utf-8"?>
<DataSchemaModel FileFormatVersion="1.2" SchemaVersion="2.9" DspName="Microsoft.Data.Tools.Schema.Sql.Sql130DatabaseSchemaProvider" CollationLcid="1033" CollationCaseSensitive="False" xmlns="http://schemas.microsoft.com/sqlserver/dac/Serialization/2012/02">
	<Header>
		<CustomData Category="AnsiNulls">
			<Metadata Name="AnsiNulls" Value="True" />
		</CustomData>
		<CustomData Category="QuotedIdentifier">
			<Metadata Name="QuotedIdentifier" Value="True" />
		</CustomData>
		<CustomData Category="CompatibilityMode">
			<Metadata Name="CompatibilityMode" Value="130" />
		</CustomData>
		<CustomData Category="Reference" Type="Assembly">
			<Metadata Name="LogicalName" Value="ETL_Event.dll" />
			<Metadata Name="FileName" Value="C:\GITHUB\ETL-ACCELERATOR\ETL_FRAMEWORK\DATABASE\ETL_EVENT\OBJ\RELEASE\ETL_EVENT.DLL" />
			<Metadata Name="AssemblyName" Value="ETL_Event" />
			<Metadata Name="PermissionSet" Value="SAFE" />
			<Metadata Name="Owner" Value="" />
			<Metadata Name="GenerateSqlClrDdl" Value="True" />
			<Metadata Name="IsVisible" Value="True" />
			<Metadata Name="IsModelAware" Value="True" />
			<Metadata Name="SkipCreationIfEmpty" Value="True" />
			<Metadata Name="AssemblySymbolsName" />
		</CustomData>
		<CustomData Category="SqlCmdVariables" Type="SqlCmdVariable" />
	</Header>
	<Model>
		<Element Type="SqlDatabaseOptions">
			<Property Name="Collation" Value="SQL_Latin1_General_CP1_CI_AS" />
			<Property Name="IsAnsiNullDefaultOn" Value="True" />
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="IsAnsiWarningsOn" Value="True" />
			<Property Name="IsArithAbortOn" Value="True" />
			<Property Name="IsConcatNullYieldsNullOn" Value="True" />
			<Property Name="IsTornPageProtectionOn" Value="False" />
			<Property Name="RecoveryMode" Value="1" />
			<Property Name="IsFullTextEnabled" Value="True" />
			<Property Name="PageVerifyMode" Value="3" />
			<Property Name="DefaultLanguage" Value="" />
			<Property Name="DefaultFullTextLanguage" Value="" />
			<Property Name="QueryStoreStaleQueryThreshold" Value="367" />
			<Relationship Name="DefaultFilegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Event]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Event].[ReceiveDT]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="3" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Event]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Event].[EventTypeID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Event].[EventID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Event].[ReceiveDT]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="3" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Event].[PostDT]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Event].[EventArgs]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlXmlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[xml]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[Event].[IX01_Event]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Event].[EventID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[Event]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlXmlSchemaCollection" Name="[dbo].[EventArgsCollection]">
			<Property Name="SchemaExpression">
				<Value><![CDATA[N'<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:t="EventArgs.XSD" targetNamespace="EventArgs.XSD">
  <xsd:element name="EventArgs" type="t:EventArgs" />
  <xsd:complexType name="EventArgs">
    <xsd:complexContent>
      <xsd:restriction base="xsd:anyType">
        <xsd:sequence />
        <xsd:attribute name="Source" type="xsd:string" use="required" />
        <xsd:attribute name="PeriodGrain" type="t:PeriodGrain" use="required" />
        <xsd:attribute name="Period" type="xsd:int" use="required" />
      </xsd:restriction>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:simpleType name="PeriodGrain">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="Year" />
      <xsd:enumeration value="Quarter" />
      <xsd:enumeration value="Month" />
      <xsd:enumeration value="Week" />
      <xsd:enumeration value="Day" />
      <xsd:enumeration value="Hour" />
      <xsd:enumeration value="Minute" />
    </xsd:restriction>
  </xsd:simpleType>
</xsd:schema>']]></Value>
			</Property>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[EventLog]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EventLog].[EventTypeID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EventLog].[EventID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EventLog].[ReceiveDT]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EventLog].[PostDT]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EventLog].[EventArgs]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlXmlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[xml]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[EventType]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EventType].[EventTypeID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EventType].[EventTypeName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EventType].[EventArgsSchema]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EventType].[SourceName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EventType].[LogRetention]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EventType].[CreateDT]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EventType].[ModifyDT]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[EventType].[IX01_EventType]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[EventType].[EventTypeName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[EventType]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[fn_EventTypeCheck]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[fn_EventTypeCheck].[@EventType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventType].[EventTypeID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventType].[EventTypeName]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[

begin
/******************************************************************************
** File:	[fn_EventTypeCheck].sql
** Name:	[dbo].[fn_EventTypeCheck]

** SD Location: /function/fn_EventTypeCheck.sql:

** Desc:	check the Event Type
**          
**
** Params:
 EventType accepts EventType Name or GUID
 
** Returns:
** 0/1 success/failure

** Author:	andrey@biasintelligence.com
** Date:	2010/03/12
** ****************************************************************************
** CHANGE HISTORY
** ****************************************************************************
** Date				Author	version	4	#bug			Description
** ----------------------------------------------------------------------------------------------------------

*/
declare @ETID uniqueidentifier

if (@EventType like '________-____-____-____-____________')
begin
  select @ETID = EventTypeID
    from dbo.EventType
   where EventTypeID = CAST(@EventType as uniqueidentifier)

end
else
begin
  select @ETID = EventTypeID
    from dbo.EventType
   where EventTypeName = @EventType
end
  
return @ETID    
end
;]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="51" />
							<Property Name="Length" Value="1274" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;select [dbo].[fn_EventTypeCheck] ('ssss')&#xD;&#xA;*/&#xD;&#xA;create function [dbo].[fn_EventTypeCheck] (@EventType sysname)&#xD;&#xA;returns uniqueidentifier&#xD;&#xA; AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[fn_EventTypeCheck].[@EventType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Event]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Event].[EventTypeID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Event]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_EventLog]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[EventLog].[EventTypeID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[EventLog].[EventID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[EventLog]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_EventType]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[EventType].[EventTypeID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[EventType]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[prc_CheckEventCondition]">
			<Property Name="BodyScript">
				<Value><![CDATA[

begin
/******************************************************************************
** File:	[prc_CheckEventCondition].sql
** Name:	[dbo].[prc_CheckEventCondition]


** Desc:	if Event.receiveDt > WatermarkEvent.receivDt then true
**          
**
** Params:
 EventType accepts EventType Name or GUID
 
** Returns:
** 0/1 success/failure

** Author:	andrey@biasintelligence.com
** Date:	2016/12/16
** ****************************************************************************
** CHANGE HISTORY
** ****************************************************************************
** Date				Author	version	4	#bug			Description
** ----------------------------------------------------------------------------------------------------------

*/
set nocount on

declare @trancount int;
declare @rows int;
declare @debug bit;
declare @msg nvarchar(1000);
declare @proc sysname;
declare @etid uniqueidentifier
declare @wetid uniqueidentifier

set @proc = object_name(@@procid);
set @trancount = @@TRANCOUNT;
set @debug = case when CHARINDEX('debug',@Options) > 0 then 1 else 0 end;

begin try

   set @etid = [dbo].[fn_EventTypeCheck] (@EventType);  
   if (@etid is null)
      raiserror ('Requested EventType %s is not found',11,11,@EventType);

   set @wetid = [dbo].[fn_EventTypeCheck] (@WatermarkEventType);  
   if (@wetid is null)
      raiserror ('Requested WatermarkEventType %s is not found',11,11,@WatermarkEventType);

	declare @eReceiveDt datetime = (select top 1 receiveDt from dbo.[Event] where EventTypeID = @etId);        
	declare @wReceiveDt datetime = (select top 1 receiveDt from dbo.[Event] where EventTypeID = @wetId);   
	
	set @Status =
		case when @eReceiveDt is null then 0
			 when @wReceiveDt is null then 1
			 when @wReceiveDt < @eReceiveDt then 1
			 else 0
		 end;
end try
begin catch
   if @@TRANCOUNT > @trancount
      rollback tran
          
   set @msg = '%s failed with the message:' + ERROR_MESSAGE();
   raiserror (@msg,11,11,@proc);
end catch
end
;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[ReceiveDT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[EventTypeID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_CheckEventCondition].[@Options]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[fn_EventTypeCheck]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_CheckEventCondition].[@EventType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_CheckEventCondition].[@WatermarkEventType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_CheckEventCondition].[@Status]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_CheckEventCondition].[@EventType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_CheckEventCondition].[@WatermarkEventType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_CheckEventCondition].[@Status]">
						<Property Name="IsOutput" Value="True" />
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_CheckEventCondition].[@Options]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="2226" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[prc_CheckEventCondition]&#xD;&#xA;&#x9;(@EventType sysname&#xD;&#xA;&#x9;,@WatermarkEventType sysname&#xD;&#xA;&#x9;,@Status bit = null output&#xD;&#xA;    ,@Options nvarchar(100) = null&#xD;&#xA;    ) AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[prc_EventGet]">
			<Property Name="BodyScript">
				<Value><![CDATA[

begin
/******************************************************************************
** File:	[prc_EventGet].sql
** Name:	[dbo].[prc_EventGet]

** SD Location: /procedure/prc_EventGet.sql:

** Desc:	returns latest Event data for a type
**          
**
** Params:
 EventType accepts EventType Name or GUID
 
** Returns:
** 0/1 success/failure

** Author:	andrey@biasintelligence.com
** Date:	2010/03/12
** ****************************************************************************
** CHANGE HISTORY
** ****************************************************************************
** Date				Author	version	4	#bug			Description
** ----------------------------------------------------------------------------------------------------------

*/
set nocount on

declare @trancount int;
declare @rows int;
declare @debug bit;
declare @msg nvarchar(1000);
declare @proc sysname;
declare @etid uniqueidentifier

set @proc = object_name(@@procid);
set @trancount = @@TRANCOUNT;
set @debug = case when CHARINDEX('debug',@Options) > 0 then 1 else 0 end;

begin try

   set @etid = [dbo].[fn_EventTypeCheck] (@EventType)      
   if (@etid is null)
      raiserror ('Requested EventType %s is not found',11,11,@EventType) 
   
   select @EventID = EventID
         ,@EventReceived = ReceiveDT
         ,@EventPosted = PostDT
         ,@EventArgs = [EventArgs]
     from dbo.[Event]
    where EventTypeID = @etid
    
end try
begin catch
   if @@TRANCOUNT > @trancount
      rollback tran
          
   set @msg = '%s failed with the message:' + ERROR_MESSAGE()
   raiserror (@msg,11,11,@proc)
end catch
end
;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventGet].[@Options]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[fn_EventTypeCheck]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventGet].[@EventType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventGet].[@EventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[EventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventGet].[@EventReceived]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[ReceiveDT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventGet].[@EventPosted]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[PostDT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventGet].[@EventArgs]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[EventArgs]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[EventTypeID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventGet].[@EventID]">
						<Property Name="IsOutput" Value="True" />
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventGet].[@EventReceived]">
						<Property Name="IsOutput" Value="True" />
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventGet].[@EventPosted]">
						<Property Name="IsOutput" Value="True" />
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventGet].[@EventArgs]">
						<Property Name="IsOutput" Value="True" />
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlXmlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[xml]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventGet].[@EventType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventGet].[@Options]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="111" />
				<Property Name="Length" Value="2025" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;declare @args xml&#xD;&#xA;exec [dbo].[prc_EventGet] @EventArgs = @args out,@EventType = 'ssss'&#xD;&#xA;select @args&#xD;&#xA;*/&#xD;&#xA;create procedure [dbo].[prc_EventGet] (&#xD;&#xA;     @EventID uniqueidentifier = null out&#xD;&#xA;&#x9;,@EventReceived datetime = null out&#xD;&#xA;&#x9;,@EventPosted datetime = null out&#xD;&#xA;&#x9;,@EventArgs xml = null out&#xD;&#xA;&#x9;,@EventType sysname&#xD;&#xA;    ,@Options nvarchar(100) = null&#xD;&#xA;    ) AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[prc_EventLogPurge]">
			<Property Name="BodyScript">
				<Value><![CDATA[

begin
/******************************************************************************
** File:	[prc_EventLogPurge].sql
** Name:	[dbo].[prc_EventLogPurge]

** SD Location: /procedure/prc_EventLogPurge.sql:

** Desc:	purge all event history based on retention policy
**          
**
** Params:
 EventType accepts EventType Name or GUID
 
** Returns:
** 0/1 success/failure

** Author:	andrey@biasintelligence.com
** Date:	2010/03/12
** ****************************************************************************
** CHANGE HISTORY
** ****************************************************************************
** Date				Author	version	4	#bug			Description
** ----------------------------------------------------------------------------------------------------------

*/
set nocount on

declare @trancount int;
declare @rows int;
declare @debug bit;
declare @msg nvarchar(1000);
declare @proc sysname;
declare @etid uniqueidentifier

set @proc = object_name(@@procid);
set @trancount = @@TRANCOUNT;
set @debug = case when CHARINDEX('debug',@Options) > 0 then 1 else 0 end;

set @Retention = nullif(@Retention,0)

begin try

   if (@EventType is not null)
   begin
      set @etid = [dbo].[fn_EventTypeCheck] (@EventType)      
      if (@etid is null)
         return
   end 

   delete l
     from dbo.EventLog l
     join dbo.EventType t on l.EventTypeID = t.EventTypeID
    where  (t.EventTypeID = @etid or @etid is null)
      and  l.ReceiveDT < dateadd(day,-ISNULL(@Retention,t.[LogRetention]),getdate()) 
      
   set @rows = @@ROWCOUNT
   raiserror ('Purge %d records from dbo.EventLog',0,1,@rows)
   
   delete l
     from dbo.[Event] l
     join dbo.EventType t on l.EventTypeID = t.EventTypeID
    where  (t.EventTypeID = @etid or @etid is null)
      and  l.ReceiveDT < dateadd(day,-ISNULL(@Retention,t.[LogRetention]),getdate()) 
      
   set @rows = @@ROWCOUNT
   raiserror ('Purge %d records from dbo.Event',0,1,@rows)
    
end try
begin catch
   if @@TRANCOUNT > @trancount
      rollback tran
          
   set @msg = '%s failed with the message:' + ERROR_MESSAGE()
   raiserror (@msg,11,11,@proc)
end catch
end
;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventLogPurge].[@Options]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventLogPurge].[@Retention]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventLogPurge].[@EventType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[fn_EventTypeCheck]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventLog]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventLog].[EventTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventType].[EventTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventLog].[ReceiveDT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventType].[LogRetention]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[EventTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventType].[EventTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[ReceiveDT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventType].[LogRetention]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventLogPurge].[@EventType]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventLogPurge].[@Retention]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventLogPurge].[@Options]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="88" />
				<Property Name="Length" Value="2442" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;exec [dbo].[prc_EventLogPurge] @EventType = 'TEST_EVENT_LOCAL',@Retention = -1&#xD;&#xA;*/&#xD;&#xA;create procedure [dbo].[prc_EventLogPurge] (&#xD;&#xA;&#x9; @EventType sysname = null&#xD;&#xA;&#x9;,@Retention int = null&#xD;&#xA;    ,@Options nvarchar(100) = null&#xD;&#xA;    ) AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[prc_EventPost]">
			<Property Name="BodyScript">
				<Value><![CDATA[

begin
/******************************************************************************
** File:	[prc_EventPost].sql
** Name:	[dbo].[prc_EventPost]


** Desc:	post an event
**          
**
** Params:
 EventType accepts EventType Name or GUID
 
** Returns:
** 0/1 success/failure

** Author:	andrey@biasintelligence.com
** Date:	2010/03/12
** ****************************************************************************
** CHANGE HISTORY
** ****************************************************************************
** Date				Author	version	4	#bug			Description
** ----------------------------------------------------------------------------------------------------------

*/
set nocount on

declare @trancount int;
declare @rows int;
declare @debug bit;
declare @msg nvarchar(1000);
declare @proc sysname;
declare @etid uniqueidentifier
declare @EventArgsExpected sysname
declare @EventArgsReceived sysname

set @proc = object_name(@@procid);
set @trancount = @@TRANCOUNT;
set @debug = case when CHARINDEX('debug',@Options) > 0 then 1 else 0 end;

begin try

   set @etid = [dbo].[fn_EventTypeCheck] (@EventType);  
   if (@etid is null)
      raiserror ('Requested EventType %s is not found',11,11,@EventType);
         
   if (@EventArgs is not null)
   begin
      select @EventArgsExpected = EventArgsSchema
        from dbo.EventType
       where EventTypeID = @etid;
         
      set @EventArgsReceived = @EventArgs.value('namespace-uri(./*[1])','sysname');
      if (@EventArgsExpected <> @EventArgsReceived)
         raiserror ('Invalid EventArgs type is received = %s. Expected %s',11,11,@EventArgsReceived,@EventArgsExpected);
   end
          
   insert dbo.EventLog
   (EventTypeID,EventID,ReceiveDT,PostDT,EventArgs)
   select s.EventTypeID,s.EventID,s.ReceiveDT,s.PostDT,s.EventArgs
    from
   (
    merge dbo.[Event] as dst
    using (select @etid,newid(),getdate(),@EventPosted,@EventArgs) as src
    (EventTypeID,EventID,ReceiveDT,PostDT,EventArgs)
    on dst.EventTypeID = src.EventTypeID
    when matched then
    update
       set dst.EventID = src.EventID
          ,dst.ReceiveDT = src.ReceiveDT
          ,dst.PostDT = src.PostDT
          ,dst.EventArgs = src.EventArgs
     when not matched by target then
     insert (EventTypeID,EventID,ReceiveDT,PostDT,EventArgs)
     values (src.EventTypeID,src.EventID,src.ReceiveDT,src.PostDT,src.EventArgs)
	 output deleted.EventTypeId,deleted.EventId,deleted.ReceiveDt,deleted.PostDt,deleted.EventArgs,$action as [Action]
	 ) s (EventTypeID,EventID,ReceiveDT,PostDT,EventArgs,[Action])
	 WHERE s.[Action] = 'UPDATE'
	 ;
       
end try
begin catch
   if @@TRANCOUNT > @trancount
      rollback tran
          
   set @msg = '%s failed with the message:' + ERROR_MESSAGE();
   raiserror (@msg,11,11,@proc);
end catch
end
;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventPost].[@Options]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[fn_EventTypeCheck]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventPost].[@EventType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventPost].[@EventArgs]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventType].[EventArgsSchema]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventType].[EventTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventLog]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventLog].[EventTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventLog].[EventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventLog].[ReceiveDT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventLog].[PostDT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventLog].[EventArgs]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventPost].[@EventPosted]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[EventTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[EventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[ReceiveDT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[PostDT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[EventArgs]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[EventTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[EventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[ReceiveDT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[PostDT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Event].[EventArgs]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventPost].[@EventType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventPost].[@EventPosted]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventPost].[@EventArgs]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlXmlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[xml]" />
										</Entry>
									</Relationship>
									<Relationship Name="XmlSchemaCollection">
										<Entry>
											<References Name="[dbo].[EventArgsCollection]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventPost].[@Options]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="89" />
				<Property Name="Length" Value="3160" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;declare @args xml&#xD;&#xA;exec [dbo].[prc_EventPost] @EventType = 'ssss'&#xD;&#xA;select @args&#xD;&#xA;*/&#xD;&#xA;create procedure [dbo].[prc_EventPost] (&#xD;&#xA;&#x9; @EventType sysname&#xD;&#xA;&#x9;,@EventPosted datetime = null&#xD;&#xA;&#x9;,@EventArgs xml(EventArgsCollection) = null&#xD;&#xA;    ,@Options nvarchar(100) = null&#xD;&#xA;    ) AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[prc_EventTypeGet]">
			<Property Name="BodyScript">
				<Value><![CDATA[

begin
/******************************************************************************
** File:	[prc_EventTypeGet].sql
** Name:	[dbo].[prc_EventTypeGet]

** SD Location: /procedure/prc_EventTypeGet.sql:

** Desc:	returns EventType Args xsd
**          
**
** Params:
 EventType accepts EventType Name or GUID
 
** Returns:
** 0/1 success/failure

** Author:	andrey@biasintelligence.com
** Date:	2010/03/12
** ****************************************************************************
** CHANGE HISTORY
** ****************************************************************************
** Date				Author	version	4	#bug			Description
** ----------------------------------------------------------------------------------------------------------

*/
set nocount on

declare @trancount int;
declare @rows int;
declare @debug bit;
declare @msg nvarchar(1000);
declare @proc sysname;
declare @etid uniqueidentifier

set @proc = object_name(@@procid);
set @trancount = @@TRANCOUNT;
set @debug = case when CHARINDEX('debug',@Options) > 0 then 1 else 0 end;

begin try

   set @etid = [dbo].[fn_EventTypeCheck] (@EventType)      
   if (@etid is null)
      raiserror ('Requested EventType %s is not found',11,11,@EventType) 
   
   select @EventArgsXSD = xml_schema_namespace('dbo','EventArgsCollection',EventArgsSchema)
         ,@EventTypeID = EventTypeID
     from dbo.EventType
    where EventTypeID = @etid
    
end try
begin catch
   if @@TRANCOUNT > @trancount
      rollback tran
          
   set @msg = '%s failed with the message:' + ERROR_MESSAGE()
   raiserror (@msg,11,11,@proc)
end catch
end
;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventTypeGet].[@Options]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[fn_EventTypeCheck]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventTypeGet].[@EventType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventTypeGet].[@EventArgsXSD]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventType].[EventArgsSchema]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[prc_EventTypeGet].[@EventTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EventType].[EventTypeID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventTypeGet].[@EventArgsXSD]">
						<Property Name="IsOutput" Value="True" />
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlXmlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[xml]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventTypeGet].[@EventTypeID]">
						<Property Name="IsOutput" Value="True" />
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventTypeGet].[@EventType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[sys].[sysname]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[prc_EventTypeGet].[@Options]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="156" />
				<Property Name="Length" Value="2001" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;--select * from eventtype&#xD;&#xA;declare @args xml&#xD;&#xA;exec [dbo].[prc_EventTypeGet] @EventArgsXSD = @args out,@EventType= 'TEST_EVENT_LOCAL'&#xD;&#xA;select @args&#xD;&#xA;*/&#xD;&#xA;create procedure [dbo].[prc_EventTypeGet] (&#xD;&#xA;&#x9;@EventArgsXSD xml = null out&#xD;&#xA;&#x9;,@EventTypeID uniqueidentifier = null out&#xD;&#xA;&#x9;,@EventType sysname&#xD;&#xA;    ,@Options nvarchar(100) = null&#xD;&#xA;    ) AS" />
			</Annotation>
		</Element>
	</Model>
</DataSchemaModel>